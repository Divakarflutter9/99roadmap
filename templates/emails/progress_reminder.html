<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Learning Progress</title>
</head>

<body
    style="margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f3f4f6;">
    <table role="presentation" border="0" cellpadding="0" cellspacing="0" width="100%" style="margin-top: 20px;">
        <tr>
            <td align="center">
                <!-- Card Container -->
                <table role="presentation" border="0" cellpadding="0" cellspacing="0" width="600"
                    style="background-color: #ffffff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">

                    <!-- Header -->
                    <tr>
                        <td bgcolor="#4f46e5" style="padding: 30px; text-align: center;">
                            <h1 style="margin: 0; color: #ffffff; font-size: 24px; font-weight: 700;">Your Weekly
                                Progress</h1>
                        </td>
                    </tr>

                    <!-- Body -->
                    <tr>
                        <td style="padding: 40px 40px 20px 40px; color: #374151; font-size: 16px; line-height: 1.6;">
                            <p style="margin-top: 0;">Hi <b>{{ user.get_full_name|default:user.email }}</b>,</p>

                            <p>{{ message_content|default:"Consistency is key! Here is a snapshot of your current learning progress. Keep pushing forward! ðŸš€" }}</p>

                            {% if enrollments %}
                            <div style="margin-top: 30px;">
                                <h3 style="color: #111827; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px;">Your Active Roadmaps</h3>

                                {% for enrollment in enrollments %}
                                <div
                                    style="margin-bottom: 25px; background-color: #f9fafb; padding: 15px; border-radius: 8px;">
                                    <div
                                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                        <span
                                            style="font-weight: 700; color: #111827; font-size: 16px;">{{enrollment.roadmap.title}}</span>
                                        <span
                                            style="background-color: #e0e7ff; color: #4338ca; padding: 2px 8px; border-radius: 12px; font-size: 12px; font-weight: 600;">{{enrollment.percentage }}% Done</span>
                                    </div>

                                    <!-- Stats Grid -->
                                    <div
                                        style="display: flex; justify-content: space-between; font-size: 13px; color: #6b7280; margin-bottom: 10px;">
                                        <span>Current Stage: <strong style="color: #4b5563;">{{enrollment.current_stage_title }}</strong></span>
                                        <span>Topics: <strong>{{ enrollment.completed_topics }}</strong> / {{enrollment.total_topics }}</span>
                                    </div>

                                    <!-- Progress Bar Background -->
                                    <div
                                        style="background-color: #e5e7eb; border-radius: 6px; height: 8px; width: 100%; overflow: hidden;">
                                        <!-- Progress Bar Fill -->
                                        <div
                                            style="background-color: #4f46e5; height: 100%; width: {{ enrollment.percentage }}%;">
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                            {% else %}
                            <div
                                style="margin-top: 30px; padding: 20px; background-color: #fce7f3; border-radius: 8px; color: #9d174d; text-align: center;">
                                <p style="margin: 0;">You haven't started any roadmaps yet!</p>
                            </div>
                            {% endif %}

                            <div style="margin-top: 40px; text-align: center;">
                                <a href="{{ site_url }}/dashboard"
                                    style="display: inline-block; padding: 12px 24px; background-color: #4f46e5; color: #ffffff; text-decoration: none; border-radius: 6px; font-weight: 600;">Continue
                                    Learning</a>
                            </div>
                        </td>
                    </tr>

                    <!-- Footer -->
                    <tr>
                        <td
                            style="padding: 30px; background-color: #f9fafb; text-align: center; color: #6b7280; font-size: 14px;">
                            <p style="margin: 0;">&copy; {% now "Y" %} 99Roadmap. Keep learning, keep growing.</p>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</body>

</html>